<!DOCTYPE html>
<html>

<head>
    <title>Now You See Me</title>
    <meta charset="UTF-8">

    <script src='https://aframe.io/releases/0.9.2/aframe.min.js'></script>
    <script src="https://raw.githack.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>

    <style>
        /* í˜„ì¬ìœ„ì¹˜ í‘œì‹œì°½ */
        #gpsDisplay {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 8px 12px;
            font-family: monospace;
            font-size: 14px;
            border-radius: 6px;
            z-index: 999;
            white-space: pre-line;
        }

    </style>
</head>

<body style="margin: 0; overflow: hidden;">
    <div id="gpsDisplay">ğŸ“ GPS Loading...</div>


    <!-- í”ë“¤ë¦¼ ë³´ì •í• ë•Œ gpsMinAccuracyë¥¼ 50ìœ¼ë¡œ í•˜ëŠ”ê²Œ ê°€ì´ë“œì¸ë° ì˜ ì•ˆë˜ëŠ”ë“¯ -->
    <a-scene vr-mode-ui="enabled: false" embedded
        arjs="sourceType: webcam; gpsMinAccuracy: 100; debugUIEnabled: false;">
        <a-camera gps-camera rotation-reader sky-detector cursor="rayOrigin: mouse"></a-camera>


        <!-- ì´ë¯¸ì§€ í‘œì‹œ ê°ì²´ -->
        <!-- í•˜ëŠ˜ í–¥í• ë•Œ ë©”ì„¸ì§€ -->
        <!-- <a-entity id="skyMessage" position="0 10 0"
            text="value: â˜ï¸ í•˜ëŠ˜ì„ í–¥í•´ ë¹„ì¶”ì…¨êµ°ìš”!; align: center; color: yellow; width: 6" visible="false"></a-entity> -->
        <a-image id="skyMessage" position="0 0 0" rotation="90 0 0"
            src="https://merkava5871.github.io/ar/assets/BGSong.png" width="1" height="1" visible="true">
        </a-image>

    </a-scene>

    <script>

        // íƒ€ê²Ÿ GPS ë³€ìˆ˜
        let targetLat = null;
        let targetLon = null;

        let objectsLoaded = false;

        // í˜„ì¬ìœ„ì¹˜ í‘œì‹œ
        const gpsDisplay = document.getElementById("gpsDisplay");
        navigator.geolocation.watchPosition(
            (pos) => {
                currentLat = pos.coords.latitude;
                currentLon = pos.coords.longitude;

                const lat = pos.coords.latitude.toFixed(6);
                const lon = pos.coords.longitude.toFixed(6);
                const alt = pos.coords.altitude !== null ? pos.coords.altitude.toFixed(1) + "m" : "none";
                //ê¸°ìš¸ê¸° í‘œì‹œ
                const camera = document.querySelector('[gps-camera]');
                const rot = camera.getAttribute('rotation');
                const pitch = rot ? rot.x.toFixed(1) + "Â°" : "measuring";



                gpsDisplay.textContent =
                    `â†”ï¸ Lat: ${lat}\nâ†•ï¸ Lon: ${lon}\nğŸ—» Alt: ${alt}\nğŸ“ Angle: ${pitch}`;
            },
            (err) => {
                gpsDisplay.textContent = "â— GPS not Found.";
            },
            { enableHighAccuracy: true }
        );


        // ì˜¤ë¸Œì íŠ¸ ë‹¤ìš´ë¡œë“œ 
        function downloadFile(url, filename) {
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.target = "_blank"; // ì¼ë¶€ ëª¨ë°”ì¼ ë¸Œë¼ìš°ì €ì—ì„œ í•„ìš”
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function extractFromMaterial(materialStr) {
            const match = materialStr.match(/src:\s*(?:url\()?(\S+?)(?:\)|;|$)/);
            return match ? match[1].replace(/['"]/g, '') : '';
        }


    </script>


</body>

</html>
